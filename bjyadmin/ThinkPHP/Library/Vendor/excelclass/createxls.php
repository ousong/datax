<?php

  


require_once './Classes/PHPExcel.php';   

  

// uncomment   

//require_once './Classes/PHPExcel/Writer/Excel5.php';     // 用于其他低版本xls   

// or   
//require_once './Classes/PHPExcel/Writer/Excel2007/StringTable.php';
//require_once './Classes/PHPExcel/Writer/IWriter.php';
//require_once './Classes/PHPExcel/Writer/Excel2007.php'; // 用于 excel-2007 格式   

  

// 创建一个处理对象实例   

$objExcel = new PHPExcel();   

  

// 创建文件格式写入对象实例, uncomment   

$objWriter = new PHPExcel_Writer_Excel5($objExcel);     // 用于其他版本格式   

// or   

//$objWriter = new PHPExcel_Writer_Excel2007($objExcel); // 用于 2007 格式   

//$objWriter->setOffice2003Compatibility(true);   

  

//*************************************   

//设置文档基本属性   

$objProps = $objExcel->getProperties();   

$objProps->setCreator("Zeal Li");   

$objProps->setLastModifiedBy("Zeal Li");   

$objProps->setTitle("Office XLS Test Document");   

$objProps->setSubject("Office XLS Test Document, Demo");   

$objProps->setDescription("Test document, generated by PHPExcel.");   

$objProps->setKeywords("office excel PHPExcel");   

$objProps->setCategory("Test");   

  

//*************************************   

//设置当前的sheet索引，用于后续的内容操作。   

//一般只有在使用多个sheet的时候才需要显示调用。   

//缺省情况下，PHPExcel会自动创建第一个sheet被设置SheetIndex=0   

$objExcel->setActiveSheetIndex(0);   

  

  

$objActSheet = $objExcel->getActiveSheet();   

  

//设置当前活动sheet的名称   

$objActSheet->setTitle('lyj');   

  

//*************************************   

//设置单元格内容   

//   

//由PHPExcel根据传入内容自动判断单元格内容类型   

$objActSheet->setCellValue('A2', '中国11');  // 字符串内容  

  




//*************************************   

//设置单元格样式   

//   

  

//设置宽度   

$objActSheet->getColumnDimension('B')->setAutoSize(true);   

$objActSheet->getColumnDimension('A')->setWidth(30);   

  


  

//设置单元格内容的数字格式。   

//   

//如果使用了 PHPExcel_Writer_Excel5 来生成内容的话，   

//这里需要注意，在 PHPExcel_Style_NumberFormat 类的 const 变量定义的   

//各种自定义格式化方式中，其它类型都可以正常使用，但当setFormatCode   

//为 FORMAT_NUMBER 的时候，实际出来的效果被没有把格式设置为"0"。需要   

//修改 PHPExcel_Writer_Excel5_Format 类源代码中的 getXf($style) 方法，   

//在 if ($this->_BIFF_version == 0x0500) { （第363行附近）前面增加一   

//行代码:   

//if($ifmt === '0') $ifmt = 1;   

//   

//设置格式为PHPExcel_Style_NumberFormat::FORMAT_NUMBER，避免某些大数字   

//被使用科学记数方式显示，配合下面的 setAutoSize 方法可以让每一行的内容   

//都按原始内容全部显示出来。   
  

//*************************************   

//输出内容   

//   

  

//生成excel到文件   
//-----------------------------------
$objWriter->save('./test1.xls');   
//------------------------------------
  

//或者直接浏览器下载   (任选其一)
//------------------------------------
/*
$outputFileName = "output.xls"; 
header("Content-Type:application/octet-stream;charset=utf-8");
header('Content-Disposition: attachment; filename=' . $outputFileName); 
$objWriter->save('php://output');
//------------------------------------

  */

?>   
 
